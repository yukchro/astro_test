---
import '/src/scss/pagefind.css';
---

<nav class="l-pokedex-nav">
  <div class="l-pokedex-nav__inner">
    <button class="l-pokedex-nav__func l-pokedex-nav--reset">Reset</button>
    <button class="l-pokedex-nav__func l-pokedex-nav--view" >Grid</button>
    <button class="l-pokedex-nav__func l-pokedex-nav--sort" id="sort-toggle">Sort</button>
    <button class="l-pokedex-nav__func l-pokedex-nav--filter" >Filter</button>
    <button class="l-pokedex-nav__search" id="search-toggle">
      <span class="l-pokedex-nav__search-rect">Search</span>
    </button>
  </div>
  <div class="l-pokedex-search" id="search"></div>
  <div class="l-pokedex-nav__sort">
    <button class="l-pokedex-nav__sort-item" data-type="number">Number</button>
    <button class="l-pokedex-nav__sort-item">Name</button>
    <button class="l-pokedex-nav__sort-item">Height</button>
    <button class="l-pokedex-nav__sort-item">Weight</button>
  </div>
</nav>

<script>
  import { PagefindUI } from '@pagefind/default-ui'
  new PagefindUI({
    element: '#search',
    showImages: true,
    translations: {
      placeholder: "input search text...",
    }
  });

  window.addEventListener('DOMContentLoaded', ()=> {
    const searchToggle = document.getElementById('search-toggle');
    const searchArea = document.querySelector('.l-pokedex-search');
    searchToggle.addEventListener('click', ()=> {
      searchArea.classList.toggle('is-active');
      searchToggle.classList.toggle('is-active');
    });

    const sortToggle = document.getElementById('sort-toggle');
    const sortArea = document.querySelector('.l-pokedex-nav__sort');

    sortToggle.addEventListener('click', ()=> {
      sortArea.classList.toggle('is-active')
    })

    const dataList = document.querySelectorAll('.pokedex-list__item');
    const sortType = document.querySelectorAll('.l-pokedex-nav__sort-item');
    sortType.forEach(t => {
      t.addEventListener('click',()=> {
        if(t.dataset.type == 'number') {
          // dataList.filter('')
        }
      })
    })
  });
</script>

<style lang="scss">
  .l-pokedex-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    padding-right: 16px;
    padding-left: 16px;
    padding-bottom: 16px;
    
    &__inner {
      position: relative;
      z-index: 8;
      background-color: rgba(#333, 0.7);
      border-radius: 24px;
      display: flex;
      justify-content: flex-end;
      backdrop-filter: blur(4px);
      color: #fff;
      
    }

    &__func {
      font-weight: 700;
    }

    &--reset {
      margin-right: 24px;
    }

    &--view {
      margin-right: 16px;
    }

    &--sort {
      margin-right: 16px;
    }
    
    &--filter {
      margin-right: 24px;
    }

    &__search {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background-color: #333;

      &.is-active::before {
        opacity: 0;
      }

      &.is-active &-rect {
        opacity: 1;
        rotate: 135deg;
      }
    }

    &__search::before {
      content: '';
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      background-image: url('/assets/images/icon-search.svg');
      background-size: 20px 20px;
      background-repeat: no-repeat;
      background-position: center;
      transition-property: opacity;
      transition-duration: 400ms;
    }
    
    &__search-rect {
      position: relative;
      font-size: 0;
      color: transparent;
      width: 16px;
      height: 2px;
      background-color: #fff;
      rotate: 0;
      opacity: 0;
      transition-property: opacity, rotate;
      transition-duration: 400ms;
    }

    &__search-rect::after {
      content: "";
      position: absolute;
      inset: 0;
      width: inherit;
      height: inherit;
      background-color: inherit;
      rotate: 90deg;
    }

    &__sort {
      position: absolute;
      bottom: calc(100% + 16px );
      left: 0;
      opacity: 0;
      pointer-events: none;
      visibility: hidden;
      background-color: #333;
      color: #fff;
      display: flex;
      flex-direction: column;
      padding: 16px;
      border-radius: 16px;

      &.is-active {
        opacity: 1;
        visibility: visible;
        pointer-events: all;
      }
    }
  }

  .l-pokedex-search {
    position: absolute;
    bottom: 16px;
    left: 16px;
    right: 16px;
    width: calc(100% - 32px);
    opacity: 0;
    pointer-events: none;
    visibility: hidden;
    scale: 1 0;
    transition-property: opacity, scale, visibility;
    transition-duration: 400ms;
    transform-origin: center bottom;

    &.is-active {
      opacity: 1;
      visibility: visible;
      pointer-events: all;
      scale: 1 1;
    }
   
  }

  .pagefind-ui__drawer {
    position: absolute;
  }
</style>